declare header
declare objectname
declare address
declare objectIdentifier
declare maxApduLenghtAccepted
declare segmentationSupported
declare vendorID
declare foreignBBMD
declare foreignTTL
declare maxsegmentsAccepted

bashio::log.info "Declared"

# Assigning value to vars from config 
header='[BACpypes]'
objectname='objectName: '
address='address: 127.0.0.1/24'
objectIdentifier='objectIdentifier : '
maxApduLenghtAccepted='maxApduLengthAccepted: '
segmentationSupported='segmentationSupported: '
vendorID='vendorIdentifier: '
foreignBBMD='foreignBBMD: '
foreignTTL='foreignTTL: '
maxsegmentsAccepted='maxsegmentsAccepted: '

bashio::log.info "$objectname"

ifconfig -a

hostname -I

objectname+="$(bashio::config 'objectname')"
objectIdentifier+="$(bashio::config 'objectIdentifier')"
maxApduLenghtAccepted+="$(bashio::config 'maxApduLenghtAccepted')"
segmentationSupported+="$(bashio::config 'segmentationSupported')"
vendorID+="$(bashio::config 'vendorID')"
foreignBBMD+="$(bashio::config 'foreignBBMD')"
foreignTTL="$(bashio::config 'foreignTTL')"
maxsegmentsAccepted+="$(bashio::config 'maxsegmentsAccepted')"

bashio::log.info "$objectname"

# Generate INI file
printf "$header \n$objectname \n$address \n$objectIdentifier \n$maxApduLenghtAccepted \n$segmentationSupported \n$vendorID \n$foreignBBMD \n$foreignTTL \n$maxsegmentsAccepted" > BACpypes.ini
cat BACpypes.ini

bashio::log.info "Running interface"

## Run your program
exec python3 /usr/bin/BACpypesFlask.py